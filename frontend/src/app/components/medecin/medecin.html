<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
    <h2 class="text-primary fw-bold mb-0"><i class="bi bi-person-badge"></i> Annuaire des Médecins</h2>
    <button class="btn btn-primary shadow-sm" data-bs-toggle="modal" data-bs-target="#medecinModal" (click)="prepareAjout()">
      <i class="bi bi-plus-lg"></i> Nouveau Médecin
    </button>
  </div>

  <!-- <div *ngIf="chargement" class="text-center my-5">
    <div class="spinner-grow text-primary" role="status"></div>
  </div> -->

  <div class="card shadow-sm border-0" *ngIf="!chargement">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="bg-light">
          <tr>
            <th class="ps-4">Médecin</th>
            <th>Email</th>
            <th>Spécialité</th>
            <th class="text-end pe-4">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let m of listeMedecins">
            <td class="ps-4">
              <div class="d-flex align-items-center">
                <div class="avatar bg-soft-primary text-primary me-3">{{ m.user.username.charAt(0) | uppercase }}</div>
                <span class="fw-semibold">{{ m.user.username }}</span>
              </div>
            </td>
            <td>{{ m.user.email }}</td>
            <td><span class="badge rounded-pill bg-info text-dark px-3">{{ m.specialite }}</span></td>
            <td class="text-end pe-4">
              <button class="btn btn-sm btn-outline-secondary me-2" (click)="prepareEdit(m)" data-bs-toggle="modal" data-bs-target="#medecinModal">
                <i class="bi bi-pencil">Modifier</i>
              </button>
              <button class="btn btn-sm btn-outline-danger" (click)="supprimer(m.id)">
                <i class="bi bi-trash">Supprimer</i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div  class="modal fade" id="medecinModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">{{ isEditMode ? 'Modifier' : 'Ajouter' }} un Médecin</h5>
          <button type="button" class="btn-close btn-close-white ml-3" data-bs-dismiss="modal" id="closeModalBtn"></button>
        </div>
        <form (ngSubmit)="enregistrer()">
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Nom Complet</label>
              <input type="text" name="username" [(ngModel)]="currentMedecin.username" class="form-control" placeholder="ex: Dr. House">
            </div>  
              <div class="mb-3" *ngIf="!isEditMode">
              <label class="form-label">Email</label>
              <input type="email" name="email" [(ngModel)]="currentMedecin.email" class="form-control">
            </div>
            <div class="mb-3" *ngIf="!isEditMode">
              <label class="form-label">Mot de passe</label>
              <input type="password" name="password" [(ngModel)]="currentMedecin.password" class="form-control">
            </div>
            <div class="mb-3">
              <label class="form-label">Spécialité</label>
              <select name="specialite" [(ngModel)]="currentMedecin.specialite" class="form-select">
                <option value="dentiste">Dentiste</option>
                <option value="sage femme">Sage Femme</option>
                <option value="generaliste">Généraliste</option>
              </select>
            </div>
          </div>
          <div class="modal-footer bg-light">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
            <button type="submit" class="btn btn-primary px-4">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>
  </div> 
</div> 